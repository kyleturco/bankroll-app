'use strict';

angular.module('bankRoll').controller('LoginCtrl', function (Profile, $rootScope, $scope, $location, API_URL, $http) {
  var vm = this;

  vm.login = function (email, password) {
    var fb = new Firebase(API_URL);

    fb.authWithPassword({
      email: vm.secret.email,
      password: vm.secret.password
    }, function (err, authData) {
      if (err) {
        console.log('Error', err);
      } else {
        $rootScope.auth = authData;
        $location.path('/overview');
        $scope.$apply();
      }
    });
  };

  vm.register = function (email, password) {
    var fb = new Firebase(API_URL);

    fb.createUser({
      email: vm.secret.email,
      password: vm.secret.password
    }, function (err, authData) {
      if (err) {
        console.log('Error', err);
      } else {
        vm.login();
        console.log('User created successfully');
        Profile.create(vm.data.uid, authData.uid, function () {
          vm.login(vm.secret.email, vm.secret.password);
        });
      }
    });
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hc3NldHMvYXV0aC9sb2dpbi5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUNKLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FFbEIsVUFBVSxDQUFDLFdBQVcsRUFBRSxVQUFVLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3pGLE1BQUksRUFBRSxHQUFHLElBQUksQ0FBQzs7QUFFZCxJQUFFLENBQUMsS0FBSyxHQUFHLFVBQVUsS0FBSyxFQUFFLFFBQVEsRUFBRTtBQUNwQyxRQUFJLEVBQUUsR0FBRyxJQUFJLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7QUFFL0IsTUFBRSxDQUFDLGdCQUFnQixDQUFDO0FBQ2xCLFdBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDdEIsY0FBUSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUTtLQUM3QixFQUFFLFVBQVUsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUMxQixVQUFJLEdBQUcsRUFBRTtBQUNQLGVBQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFBO09BQzFCLE1BQU07QUFDTCxrQkFBVSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUM7QUFDM0IsaUJBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDNUIsY0FBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO09BQ2pCO0tBQ0YsQ0FBQyxDQUFDO0dBQ0osQ0FBQzs7QUFFRixJQUFFLENBQUMsUUFBUSxHQUFHLFVBQVUsS0FBSyxFQUFFLFFBQVEsRUFBRTtBQUN2QyxRQUFJLEVBQUUsR0FBRyxJQUFJLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7QUFFL0IsTUFBRSxDQUFDLFVBQVUsQ0FBQztBQUNaLFdBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDdEIsY0FBUSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUTtLQUM3QixFQUFFLFVBQVUsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUMxQixVQUFJLEdBQUcsRUFBRTtBQUNQLGVBQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFBO09BQzFCLE1BQU07QUFDTCxVQUFFLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDWCxlQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixDQUFDLENBQUM7QUFDekMsZUFBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsR0FBRyxFQUFFLFlBQVU7QUFDbEQsWUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQy9DLENBQUMsQ0FBQTtPQUNIO0tBQ0YsQ0FBQyxDQUFBO0dBQ0gsQ0FBQztDQUNILENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvYXNzZXRzL2F1dGgvbG9naW4uY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXJcbiAgLm1vZHVsZSgnYmFua1JvbGwnKVxuXG4gIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoUHJvZmlsZSwgJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24sIEFQSV9VUkwsICRodHRwKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIHZtLmxvZ2luID0gZnVuY3Rpb24gKGVtYWlsLCBwYXNzd29yZCkge1xuICAgICAgdmFyIGZiID0gbmV3IEZpcmViYXNlKEFQSV9VUkwpO1xuXG4gICAgICBmYi5hdXRoV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgZW1haWw6IHZtLnNlY3JldC5lbWFpbCxcbiAgICAgICAgcGFzc3dvcmQ6IHZtLnNlY3JldC5wYXNzd29yZFxuICAgICAgfSwgZnVuY3Rpb24gKGVyciwgYXV0aERhdGEpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcicsIGVycilcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkcm9vdFNjb3BlLmF1dGggPSBhdXRoRGF0YTtcbiAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL292ZXJ2aWV3Jyk7XG4gICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdm0ucmVnaXN0ZXIgPSBmdW5jdGlvbiAoZW1haWwsIHBhc3N3b3JkKSB7XG4gICAgICB2YXIgZmIgPSBuZXcgRmlyZWJhc2UoQVBJX1VSTCk7XG5cbiAgICAgIGZiLmNyZWF0ZVVzZXIoe1xuICAgICAgICBlbWFpbDogdm0uc2VjcmV0LmVtYWlsLMKgXG4gICAgICAgIHBhc3N3b3JkOiB2bS5zZWNyZXQucGFzc3dvcmRcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnIsIGF1dGhEYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3InLCBlcnIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0ubG9naW4oKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgY3JlYXRlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgUHJvZmlsZS5jcmVhdGUodm0uZGF0YS51aWQsIGF1dGhEYXRhLnVpZCwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZtLmxvZ2luKHZtLnNlY3JldC5lbWFpbCwgdm0uc2VjcmV0LnBhc3N3b3JkKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH07XG4gIH0pO1xuXG4iXX0=
