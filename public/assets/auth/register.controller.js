'use strict';

angular.module('bankRoll').controller('RegisterCtrl', function ($scope, $location, API_URL, $http, currentUser) {
  var vm = this;

  vm.login = function (email, password) {
    var fb = new Firebase(API_URL);

    fb.authWithPassword({
      email: vm.email,
      password: vm.password
    }, function (err, authData) {
      if (err) {
        console.log('Error', err);
      } else {
        currentUser.set(authData);
        $location.path('/overview');
        $scope.$apply();
      }
    });
  };

  vm.register = function (email, password) {
    var ref = new Firebase('https://bankroll.firebaseio.com/profiles/');

    ref.createUser({
      name: vm.name,
      email: vm.email,
      password: vm.password
    }, function (err, authData) {
      if (err) {
        console.log('Error', err);
      } else {
        vm.login();
        console.log('User created successfully');

        currentUser.set(authData);
        // currentUser === {}
        var profile = {};
        ref.child(authData.uid).set(profile);
      }
    });
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hc3NldHMvYXV0aC9yZWdpc3Rlci5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUNKLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FFbEIsVUFBVSxDQUFDLGNBQWMsRUFBRSxVQUFVLE1BQU0sRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7QUFDcEYsTUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDOztBQUVkLElBQUUsQ0FBQyxLQUFLLEdBQUcsVUFBVSxLQUFLLEVBQUUsUUFBUSxFQUFFO0FBQ3BDLFFBQUksRUFBRSxHQUFHLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUUvQixNQUFFLENBQUMsZ0JBQWdCLENBQUM7QUFDbEIsV0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLO0FBQ2YsY0FBUSxFQUFFLEVBQUUsQ0FBQyxRQUFRO0tBQ3RCLEVBQUUsVUFBVSxHQUFHLEVBQUUsUUFBUSxFQUFFO0FBQzFCLFVBQUksR0FBRyxFQUFFO0FBQ1AsZUFBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUE7T0FDMUIsTUFBTTtBQUNMLG1CQUFXLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFCLGlCQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQzVCLGNBQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztPQUNqQjtLQUNGLENBQUMsQ0FBQztHQUNKLENBQUM7O0FBRUYsSUFBRSxDQUFDLFFBQVEsR0FBRyxVQUFVLEtBQUssRUFBRSxRQUFRLEVBQUU7QUFDdkMsUUFBSSxHQUFHLEdBQUcsSUFBSSxRQUFRLENBQUMsMkNBQTJDLENBQUMsQ0FBQzs7QUFFcEUsT0FBRyxDQUFDLFVBQVUsQ0FBQztBQUNiLFVBQUksRUFBRSxFQUFFLENBQUMsSUFBSTtBQUNiLFdBQUssRUFBRSxFQUFFLENBQUMsS0FBSztBQUNmLGNBQVEsRUFBRSxFQUFFLENBQUMsUUFBUTtLQUN0QixFQUFFLFVBQVUsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUMxQixVQUFJLEdBQUcsRUFBRTtBQUNQLGVBQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFBO09BQzFCLE1BQU07QUFDTCxVQUFFLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDWCxlQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixDQUFDLENBQUM7O0FBRXpDLG1CQUFXLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUUxQixZQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7QUFDakIsV0FBRyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO09BQ3JDO0tBQ0YsQ0FBQyxDQUFBO0dBQ0gsQ0FBQztDQUNILENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvYXNzZXRzL2F1dGgvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXJcbiAgLm1vZHVsZSgnYmFua1JvbGwnKVxuXG4gIC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIEFQSV9VUkwsICRodHRwLCBjdXJyZW50VXNlcikge1xuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICB2bS5sb2dpbiA9IGZ1bmN0aW9uIChlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShBUElfVVJMKTtcblxuICAgICAgZmIuYXV0aFdpdGhQYXNzd29yZCh7XG4gICAgICAgIGVtYWlsOiB2bS5lbWFpbCxcbiAgICAgICAgcGFzc3dvcmQ6IHZtLnBhc3N3b3JkXG4gICAgICB9LCBmdW5jdGlvbiAoZXJyLCBhdXRoRGF0YSkge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yJywgZXJyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRVc2VyLnNldChhdXRoRGF0YSk7XG4gICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9vdmVydmlldycpO1xuICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZtLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGVtYWlsLCBwYXNzd29yZCkge1xuICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZSgnaHR0cHM6Ly9iYW5rcm9sbC5maXJlYmFzZWlvLmNvbS9wcm9maWxlcy8nKTtcblxuICAgICAgcmVmLmNyZWF0ZVVzZXIoe1xuICAgICAgICBuYW1lOiB2bS5uYW1lLFxuICAgICAgICBlbWFpbDogdm0uZW1haWwswqBcbiAgICAgICAgcGFzc3dvcmQ6IHZtLnBhc3N3b3JkXG4gICAgICB9LCBmdW5jdGlvbiAoZXJyLCBhdXRoRGF0YSkge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yJywgZXJyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZtLmxvZ2luKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuXG4gICAgICAgICAgY3VycmVudFVzZXIuc2V0KGF1dGhEYXRhKTtcbiAgICAgICAgICAvLyBjdXJyZW50VXNlciA9PT0ge31cbiAgICAgICAgICB2YXIgcHJvZmlsZSA9IHt9O1xuICAgICAgICAgIHJlZi5jaGlsZChhdXRoRGF0YS51aWQpLnNldChwcm9maWxlKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH07XG4gIH0pO1xuIl19
